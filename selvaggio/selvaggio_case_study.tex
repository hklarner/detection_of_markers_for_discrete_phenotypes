
\documentclass[11pt]{article}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage[ruled,vlined,noend]{algorithm2e}
\usepackage{algpseudocode}
\usepackage{fancyvrb}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{hyperref}
\usepackage{listings}

\newtheorem{example}{Example}[section]
\newtheorem{definition}{Definition}[section]


\begin{document}
    \title{Technical report: Marker detection and control of the EMT network}
    \author{Hannes Klarner$^1$ \and Elisa Tonello$^1$ \and Laura F.-Cifuentes$^1$ \and Heike Siebert$^1$}
    \date{%
        $^1$Freie Universit√§t Berlin, Berlin, Germany\\%
        January 2022
    }
    \maketitle

    \section{Introduction}\label{sec:introduction}
        This report summarizes some results regarding the EMT network published in \cite{selvaggio2020hybrid} and the marker detection approach published in \cite{klarner2021marker_detection}.
        All figures and tables were generated using the tool \texttt{biomarkers}, available at \url{https://github.com/hklarner/detection_of_markers_for_discrete_phenotypes}.
        The \texttt{biomarkers} commands are detailed for each type of figure.
        The results cover two areas:

        \begin{enumerate}
            \item marker detection and marker representation
            \item network control
        \end{enumerate}

        The marker detection approach is detailed in \cite{klarner2021marker_detection} and the network control is mainly meant to serve as a validation and comparison with the more elaborate work of L.~F.~Cifuentes.

        The network is described and published in \cite{selvaggio2020hybrid}.
        The authors describe nine discrete phenotypes that are defined in terms of the five network components AJ\_b1, AJ\_b2, FA\_b1, FA\_b2, FA\_b3.
        The definition of the phenotypes is given in table~\ref{tab:phenotypes}.

        \begin{table}
            \centering
            \begin{tabular}{llllll}
                \toprule
                Phenotype &  AJ\_b1 & AJ\_b2 & FA\_b1 & FA\_b2 & FA\_b3 \\
                \midrule
                E1 & 1 & 1 & 0 & 0 & 0\\
                H1 & 1 & 1 & 1 & 0 & 0\\
                H2 & 1 & 0 & 1 & 1 & 0\\
                H3 & 1 & 1 & 1 & 1 & 1\\
                M1 & 0 & 0 & 1 & 0 & 0\\
                M2 & 0 & 0 & 1 & 1 & 0\\
                M3 & 0 & 0 & 1 & 1 & 1\\
                M  & 0 & 0 & 1 & - & -\\
                UN & 0 & 0 & 0 & 0 & 0\\
                \bottomrule
            \end{tabular}
            \caption{The nine phenotypes that are considered in this report. Note that AJ\_b2=0 in H2 is correct.}
            \label{tab:phenotypes}
        \end{table}

        The network consists of 56 components and has 1452 steady states.
        It models the plasticity and metastasis of cancer cells in the context of the epithelial-to-mesenchymal transition (EMT).
        The model predicts epithelial, mesenchymal and hybrid phenotypes that appear in response to extrinsic signals.

        \begin{figure}[htp]
            \centering\label{fig:steady-state-correlation}
            \includegraphics[height=\textheight]{autogenerated/steady_state_correlation}
            \caption{The nine blocks of the steady state correlation analysis.}
        \end{figure}

        \begin{table}
            \centering\label{tab:correlated-components}
            \input{autogenerated/steady_state_correlation.tex}
            \caption{The nine blocks of the steady state correlation analysis.}
        \end{table}

    \section{Markers}\label{sec:markers}
        The following nine subsections summarize the results for the marker detection of the nine phenotypes of Table~\ref{tab:phenotypes}.
        For each phenotype it gives details on the subset minimal markers sets of between 1 and 5 components and forbidding the phenotype components.
        It takes two commands to define and solve the marker detection problem and two commands to create the marker frequency graph and compute a factorization of the marker sets.

        \begin{lstlisting}[label={lst:lstlisting},basicstyle=\ttfamily,columns=fullflexible,breakindent=0pt,breakatwhitespace,]
        biomarkers problem-create --problem m1_problem.json --bnet selvaggio_emt --phenotype AJ_b1=0,AJ_b2=0,FA_b1=1,FA_b2=0,FA_b3=0
        biomarkers problem-solve --problem m1_problem.json --forbidden AJ_b1,AJ_b2,FA_b1,FA_b2,FA_b3 --marker-size-max 5 --markers m1_markers.json
        biomarkers markers-graph --markers m1_markers.json --graph m1_markers_graph.pdf
        biomarkers markers-factorize --markers m1_markers.json --tex m1_markers_factorization.tex
        \end{lstlisting}

        \input{autogenerated/tables_and_figures.tex}


    \section{Control}\label{sec:control}


    \bibliographystyle{unsrt}
    \bibliography{selvaggio_case_study}

\end{document}

\begin{figure}[htp]
      \centering
      \label{figur}\caption{equation...}

      \subfloat[Subcaption 1]{\label{figure:1}\includegraphics[width=60mm]{run_selvaggio/e1_markers_graph.pdf}}
      \subfloat[Subcaption 2]{\label{figure:2}\includegraphics[width=60mm]{run_selvaggio/h1_markers_graph.pdf}}
      \\
      \subfloat[Subcaption 3]{\label{figure:3}\includegraphics[width=60mm]{run_selvaggio/h2_markers_graph.pdf}}
      \subfloat[Subcaption 4]{\label{figure:4}\includegraphics[width=60mm]{run_selvaggio/h3_markers_graph.pdf}}
      \\
      \subfloat[Subcaption 5]{\label{figure:5}\includegraphics[width=60mm]{run_selvaggio/m1_markers_graph.pdf}}
      \subfloat[Subcaption 6]{\label{figure:6}\includegraphics[width=60mm]{run_selvaggio/m2_markers_graph.pdf}}
      \\
      \subfloat[Subcaption 5]{\label{figure:7}\includegraphics[width=60mm]{run_selvaggio/m3_markers_graph.pdf}}
      \subfloat[Subcaption 6]{\label{figure:8}\includegraphics[width=6 0mm]{run_selvaggio/un_markers_graph.pdf}}

    \end{figure}